<div class="parametres-container">

  <!-- â”€â”€ En-tÃªte â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="page-header">
    <div class="header-left">
      <h1>âš™ï¸ ParamÃ¨tres</h1>
      <p class="subtitle">Gestion de votre compte entreprise â€” {{ currentUser?.nomEntreprise }}</p>
    </div>
    <div class="header-badge" *ngIf="currentUser">
      <span class="role-badge">{{ currentUser.role }}</span>
    </div>
  </div>

  <!-- â”€â”€ Messages flash â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="alert alert-success" *ngIf="successMessage">
    <span class="alert-icon">âœ…</span> {{ successMessage }}
  </div>
  <div class="alert alert-error" *ngIf="errorMessage">
    <span class="alert-icon">âŒ</span> {{ errorMessage }}
  </div>

  <!-- â”€â”€ Chargement â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Chargement du profilâ€¦</p>
  </div>

  <div class="settings-layout" *ngIf="!isLoading">

    <!-- â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <aside class="settings-sidebar">

      <!-- Avatar entreprise -->
      <div class="sidebar-profile">
        <div class="company-avatar">{{ getInitiales() }}</div>
        <p class="sidebar-company-name">{{ currentUser?.nomEntreprise || 'â€”' }}</p>
        <p class="sidebar-username">@{{ currentUser?.username }}</p>
        <span class="sidebar-type-badge" *ngIf="currentUser?.typeEntreprise">
          {{ getTypeLabel(currentUser!.typeEntreprise!) }}
        </span>
      </div>

      <nav class="sidebar-nav">
        <button class="nav-item" [class.active]="activeSection === 'company'"
                (click)="setActiveSection('company')">
          <span class="nav-icon">ğŸ¢</span>
          <span>Profil entreprise</span>
        </button>
        <button class="nav-item" [class.active]="activeSection === 'security'"
                (click)="setActiveSection('security')">
          <span class="nav-icon">ğŸ”’</span>
          <span>SÃ©curitÃ©</span>
        </button>
        <button class="nav-item" [class.active]="activeSection === 'notifications'"
                (click)="setActiveSection('notifications')">
          <span class="nav-icon">ğŸ””</span>
          <span>Notifications</span>
        </button>
        <button class="nav-item" [class.active]="activeSection === 'appearance'"
                (click)="setActiveSection('appearance')">
          <span class="nav-icon">ğŸ¨</span>
          <span>Apparence</span>
        </button>
        <button class="nav-item" [class.active]="activeSection === 'api'"
                (click)="setActiveSection('api')">
          <span class="nav-icon">ğŸ”‘</span>
          <span>ClÃ©s API</span>
        </button>
      </nav>
    </aside>

    <!-- â”€â”€ Contenu principal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <main class="settings-content">

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           PROFIL ENTREPRISE
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="settings-section" *ngIf="activeSection === 'company'">

        <!-- Carte identitÃ© -->
        <div class="profile-card">
          <div class="profile-card-avatar">{{ getInitiales() }}</div>
          <div class="profile-card-info">
            <h2>{{ currentUser?.nomEntreprise || 'Entreprise' }}</h2>
            <p class="meta-row">
              <span class="meta-chip">{{ getTypeLabel(currentUser?.typeEntreprise ?? '') }}</span>
              <span class="meta-chip">{{ currentUser?.secteurActivite }}</span>
            </p>
            <p class="meta-row text-muted">
              <span>ğŸ“§ {{ currentUser?.email }}</span>
              <span>ğŸ“± {{ currentUser?.telephone }}</span>
            </p>
          </div>
        </div>

        <h3 class="section-title">Informations de l'entreprise</h3>

        <div class="form-grid">

          <!-- Nom entreprise -->
          <div class="form-group full-width">
            <label class="form-label">
              Nom de l'entreprise <span class="required">*</span>
            </label>
            <input type="text"
                   [(ngModel)]="companyForm.nomEntreprise"
                   class="form-input"
                   placeholder="Ex : DouniyaConnect SARL">
          </div>

          <!-- Type entreprise -->
          <div class="form-group">
            <label class="form-label">Type d'entreprise <span class="required">*</span></label>
            <select [(ngModel)]="companyForm.typeEntreprise" class="form-select">
              <option value="" disabled>SÃ©lectionnerâ€¦</option>
              <option *ngFor="let type of typesEntreprise" [value]="type">
                {{ getTypeLabel(type) }}
              </option>
            </select>
          </div>

          <!-- Secteur d'activitÃ© -->
          <div class="form-group">
            <label class="form-label">Secteur d'activitÃ© <span class="required">*</span></label>
            <select [(ngModel)]="companyForm.secteurActivite" class="form-select">
              <option value="" disabled>SÃ©lectionnerâ€¦</option>
              <option *ngFor="let s of secteurs" [value]="s">{{ s }}</option>
            </select>
          </div>

          <!-- Email -->
          <div class="form-group">
            <label class="form-label">Email professionnel</label>
            <input type="email"
                   [(ngModel)]="companyForm.email"
                   class="form-input"
                   placeholder="contact@entreprise.com">
          </div>

          <!-- TÃ©lÃ©phone -->
          <div class="form-group">
            <label class="form-label">TÃ©lÃ©phone</label>
            <input type="tel"
                   [(ngModel)]="companyForm.telephone"
                   class="form-input"
                   placeholder="+225 XX XX XX XX XX">
          </div>

          <!-- Adresse physique -->
          <div class="form-group full-width">
            <label class="form-label">Adresse physique</label>
            <input type="text"
                   [(ngModel)]="companyForm.adressePhysique"
                   class="form-input"
                   placeholder="Rue, quartier, villeâ€¦">
          </div>

          <!-- NÂ° Registre de commerce -->
          <div class="form-group">
            <label class="form-label">NÂ° Registre de commerce</label>
            <input type="text"
                   [(ngModel)]="companyForm.numeroRegistreCommerce"
                   class="form-input"
                   placeholder="CI-ABJ-2024-B-12345">
          </div>

          <!-- Site web -->
          <div class="form-group">
            <label class="form-label">Site web</label>
            <input type="url"
                   [(ngModel)]="companyForm.siteWeb"
                   class="form-input"
                   placeholder="https://www.entreprise.com">
          </div>

          <!-- Description -->
          <div class="form-group full-width">
            <label class="form-label">Description de l'entreprise</label>
            <textarea [(ngModel)]="companyForm.description"
                      class="form-input form-textarea"
                      rows="4"
                      placeholder="DÃ©crivez votre entreprise, ses activitÃ©s, sa missionâ€¦"></textarea>
          </div>

        </div>

        <!-- Infos lecture seule -->
        <div class="readonly-card">
          <h4>Informations de connexion</h4>
          <div class="readonly-grid">
            <div class="readonly-item">
              <span class="readonly-label">Nom d'utilisateur</span>
              <span class="readonly-value">@{{ currentUser?.username }}</span>
            </div>
            <div class="readonly-item">
              <span class="readonly-label">Identifiant</span>
              <span class="readonly-value">#{{ currentUser?.id }}</span>
            </div>
            <div class="readonly-item">
              <span class="readonly-label">RÃ´le</span>
              <span class="readonly-value role-text">{{ currentUser?.role }}</span>
            </div>
            <div class="readonly-item">
              <span class="readonly-label">Membre depuis</span>
              <span class="readonly-value">{{ currentUser?.createdAt | date:'dd/MM/yyyy' }}</span>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button class="btn-secondary" (click)="setActiveSection('security')">
            ğŸ”’ Changer le mot de passe
          </button>
          <button class="btn-primary" (click)="saveCompanyInfo()" [disabled]="isSaving">
            <span *ngIf="!isSaving">ğŸ’¾ Sauvegarder</span>
            <span *ngIf="isSaving">â³ Sauvegardeâ€¦</span>
          </button>
        </div>
      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           SÃ‰CURITÃ‰
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="settings-section" *ngIf="activeSection === 'security'">
        <h3 class="section-title">SÃ©curitÃ© du compte</h3>

        <!-- 2FA -->
        <div class="toggle-list">
          <div class="toggle-item">
            <div class="toggle-info">
              <h4>Authentification Ã  deux facteurs (2FA)</h4>
              <p>ProtÃ©ger votre compte avec une couche de sÃ©curitÃ© supplÃ©mentaire</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" [(ngModel)]="securitySettings.twoFactorAuth">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- Session timeout -->
        <div class="form-grid" style="margin-bottom: 2rem;">
          <div class="form-group">
            <label class="form-label">Expiration de session</label>
            <select [(ngModel)]="securitySettings.sessionTimeout" class="form-select">
              <option value="15">15 minutes</option>
              <option value="30">30 minutes</option>
              <option value="60">1 heure</option>
              <option value="120">2 heures</option>
            </select>
          </div>
        </div>

        <!-- Changer le mot de passe -->
        <div class="password-section">
          <div class="password-header" (click)="togglePasswordForm()">
            <div>
              <h4>Changer le mot de passe</h4>
              <p>DerniÃ¨re modification : non disponible</p>
            </div>
            <button class="btn-toggle-pwd">
              {{ showPasswordForm ? 'â–² Masquer' : 'â–¼ Modifier' }}
            </button>
          </div>

          <div class="password-form" *ngIf="showPasswordForm">
            <div class="form-grid">
              <div class="form-group full-width">
                <label class="form-label">Mot de passe actuel <span class="required">*</span></label>
                <input type="password"
                       [(ngModel)]="passwordForm.currentPassword"
                       class="form-input"
                       placeholder="Votre mot de passe actuel">
              </div>
              <div class="form-group">
                <label class="form-label">Nouveau mot de passe <span class="required">*</span></label>
                <input type="password"
                       [(ngModel)]="passwordForm.newPassword"
                       class="form-input"
                       placeholder="Min. 8 caractÃ¨res">
              </div>
              <div class="form-group">
                <label class="form-label">Confirmer <span class="required">*</span></label>
                <input type="password"
                       [(ngModel)]="passwordForm.confirmPassword"
                       class="form-input"
                       placeholder="RÃ©pÃ©ter le nouveau mot de passe">
              </div>
            </div>

            <!-- Indicateur force -->
            <div class="password-strength" *ngIf="passwordForm.newPassword.length > 0">
              <span class="strength-label">Force :</span>
              <div class="strength-bar">
                <div class="strength-fill"
                     [style.width.%]="getPasswordStrength()"
                     [class.weak]="getPasswordStrength() < 40"
                     [class.medium]="getPasswordStrength() >= 40 && getPasswordStrength() < 70"
                     [class.strong]="getPasswordStrength() >= 70">
                </div>
              </div>
              <span class="strength-text">{{ getPasswordStrengthLabel() }}</span>
            </div>

            <div class="form-actions">
              <button class="btn-secondary" (click)="togglePasswordForm()">Annuler</button>
              <button class="btn-primary" (click)="savePassword()" [disabled]="isSaving">
                <span *ngIf="!isSaving">ğŸ”’ Changer le mot de passe</span>
                <span *ngIf="isSaving">â³ En coursâ€¦</span>
              </button>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button class="btn-primary" (click)="saveSecurity()">ğŸ’¾ Sauvegarder</button>
        </div>
      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           NOTIFICATIONS
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="settings-section" *ngIf="activeSection === 'notifications'">
        <h3 class="section-title">PrÃ©fÃ©rences de notification</h3>
        <div class="toggle-list">
          <div class="toggle-item">
            <div class="toggle-info">
              <h4>Notifications par email</h4>
              <p>Alertes, rappels et rÃ©sumÃ©s par email</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" [(ngModel)]="notificationSettings.emailNotifications">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-item">
            <div class="toggle-info">
              <h4>Notifications SMS</h4>
              <p>Alertes critiques par SMS</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" [(ngModel)]="notificationSettings.smsNotifications">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-item">
            <div class="toggle-info">
              <h4>Mises Ã  jour des projets</h4>
              <p>Changements de statut sur vos projets B2B</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" [(ngModel)]="notificationSettings.orderUpdates">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-item">
            <div class="toggle-info">
              <h4>Newsletters & Offres</h4>
              <p>ActualitÃ©s et opportunitÃ©s du rÃ©seau</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" [(ngModel)]="notificationSettings.newsletter">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn-primary" (click)="saveNotifications()">ğŸ’¾ Sauvegarder</button>
        </div>
      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           APPARENCE
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="settings-section" *ngIf="activeSection === 'appearance'">
        <h3 class="section-title">Apparence & Localisation</h3>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">ThÃ¨me</label>
            <select [(ngModel)]="appearanceSettings.theme" class="form-select">
              <option value="light">â˜€ï¸ Clair</option>
              <option value="dark">ğŸŒ™ Sombre</option>
              <option value="auto">âš™ï¸ Automatique</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Langue</label>
            <select [(ngModel)]="appearanceSettings.language" class="form-select">
              <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
              <option value="en">ğŸ‡¬ğŸ‡§ English</option>
              <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Format de date</label>
            <select [(ngModel)]="appearanceSettings.dateFormat" class="form-select">
              <option value="DD/MM/YYYY">DD/MM/YYYY</option>
              <option value="MM/DD/YYYY">MM/DD/YYYY</option>
              <option value="YYYY-MM-DD">YYYY-MM-DD</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Devise</label>
            <select [(ngModel)]="appearanceSettings.currency" class="form-select">
              <option value="XOF">XOF (FCFA)</option>
              <option value="EUR">EUR (â‚¬)</option>
              <option value="USD">USD ($)</option>
            </select>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn-primary" (click)="saveAppearance()">ğŸ’¾ Sauvegarder</button>
        </div>
      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CLÃ‰S API
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="settings-section" *ngIf="activeSection === 'api'">
        <h3 class="section-title">ClÃ©s API</h3>
        <p class="section-desc">GÃ©rez les clÃ©s d'accÃ¨s Ã  l'API DouniyaConnect pour vos intÃ©grations.</p>

        <button class="btn-primary mb-3" (click)="generateApiKey()">
          â• GÃ©nÃ©rer une nouvelle clÃ©
        </button>

        <div class="api-keys-list">
          <div class="api-key-card" *ngFor="let key of apiKeys">
            <div class="api-key-icon">ğŸ”‘</div>
            <div class="api-key-info">
              <h4>{{ key.name }}</h4>
              <code class="api-key-value">{{ key.key }}</code>
              <div class="api-key-meta">
                <span>ğŸ“… CrÃ©Ã©e le {{ key.created }}</span>
                <span>â± DerniÃ¨re utilisation : {{ key.lastUsed }}</span>
              </div>
            </div>
            <div class="api-key-actions">
              <button class="btn-icon" title="Copier" (click)="copyApiKey(key.key)">ğŸ“‹</button>
              <button class="btn-danger-outline" (click)="revokeApiKey(key)">RÃ©voquer</button>
            </div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <!-- â”€â”€ Zone dangereuse â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="danger-zone" *ngIf="!isLoading">
    <div class="danger-header">
      <span class="danger-icon">âš ï¸</span>
      <div>
        <h3>Zone dangereuse</h3>
        <p>Ces actions sont irrÃ©versibles. ProcÃ©dez avec prÃ©caution.</p>
      </div>
    </div>
    <div class="danger-actions">
      <button class="btn-danger-outline" (click)="exportData()">
        ğŸ“¥ Exporter mes donnÃ©es
      </button>
      <button class="btn-danger" (click)="deleteAccount()">
        ğŸ—‘ï¸ Supprimer le compte
      </button>
    </div>
  </div>

</div>
